Option Explicit

Sub Auto_Open()
 
	Dim 불러_올_파일 As String
	Dim 파일번호 As Integer
	Dim 한줄 As String
	Dim 배열 As Variant
	Dim idx As Integer
 
	불러_올_파일 = ThisWorkbook.Path & "\" & "mem_statistics.csv"
	파일번호 = FreeFile		' In VB you can open files and then manipulate them using FreeFile
 
	Range("A1").CurrentRegion.ClearContents
 
	Open 불러_올_파일 For Input As #파일번호
 
	Do Until EOF(파일번호)
 
		Line Input #파일번호, 한줄
		배열 = Split(한줄, ",")
 
		With Range("A1").Offset(idx)
			.Resize(1, UBound(배열) + 1).Value = 배열	' UBound 함수는 배열의 크기를 반환한다.
		End With
 
		idx = idx + 1
	Loop
 
	Close #파일번호
 
	Range("A1").CurrentRegion.Columns.AutoFit
	
	' Config_gathering의 불필요한 정보 삭제 (시스템 정보만 남기기 위한 작업)
	Workbooks.Open Filename:="C:\Temp\201512071330_config_gathering.txt"

	With Range("A37:A3000")
		.Select
		.Delete Shift:=xlShiftUp
	End With

	' Config_gathering의 시스템 정보 부분만 선택
	With Range("A1:A36")
		.Select
		.Copy
	End With

	' Config_gathering에서 시스템 정보만 수집한 뒤 해당 파일을 닫는다.
	Workbooks("201512071330_config_gathering.txt").Clear SaveChanges:=False

	With Range("A99")
		.Select
		.EntireRow.Insert Shift:=xlShiftDown, CopyOrigin:=True
	End With

End Sub
